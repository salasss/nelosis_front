---
import Button from "../components/Button.astro";
---

<section
  class="relative min-h-screen flex items-center overflow-hidden pt-20"
  id="hero"
>
  <!-- Dynamic Background -->
  <div class="absolute inset-0 z-0">
    <div
      class="absolute top-0 left-0 w-full h-full bg-gradient-to-br from-dark via-dark-secondary to-dark opacity-95"
    >
    </div>
    <div
      class="absolute top-[-10%] right-[-10%] w-[800px] h-[800px] bg-primary/10 rounded-full blur-[120px] animate-pulse-glow"
    >
    </div>
    <div
      class="absolute bottom-[-10%] left-[-10%] w-[600px] h-[600px] bg-accent/5 rounded-full blur-[100px] animate-float"
    >
    </div>
  </div>

  <div class="container mx-auto px-6 relative z-10">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
      <!-- Left Column: Text -->
      <div class="hero-text space-y-8 order-2 lg:order-1">
        <div class="overflow-hidden">
          <div
            class="inline-block px-4 py-2 rounded-full border border-white/10 bg-white/5 backdrop-blur-sm mb-6 transform translate-y-full opacity-0 transition-all duration-700 ease-out"
            id="hero-badge"
          >
            <span class="text-accent text-sm font-bold tracking-wider uppercase"
              >Réseau Étudiant National</span
            >
          </div>
        </div>

        <div class="overflow-hidden">
          <h1
            class="text-5xl md:text-7xl lg:text-8xl font-display font-bold leading-[1.1] transform translate-y-full opacity-0 transition-all duration-1000 delay-100 ease-out"
            id="hero-title"
          >
            <span class="block text-white">Innover</span>
            <span
              class="block text-transparent bg-clip-text bg-gradient-to-r from-primary to-highlight"
              >pour le futur</span
            >
          </h1>
        </div>

        <div class="overflow-hidden">
          <p
            class="text-xl text-text-muted max-w-lg leading-relaxed transform translate-y-full opacity-0 transition-all duration-1000 delay-300 ease-out"
            id="hero-subtitle"
          >
            Le Réseau Nélosis propulse les initiatives étudiantes à impact
            écologique. Rejoignez le mouvement qui transforme les campus.
          </p>
        </div>

        <div
          class="flex flex-wrap gap-6 transform translate-y-10 opacity-0 transition-all duration-1000 delay-500 ease-out"
          id="hero-cta"
        >
          <Button href="#programs" variant="primary" class="glow-box"
            >Explorer les projets</Button
          >
          <Button href="#contact" variant="outline">Devenir membre</Button>
        </div>

        <!-- Stats Mini -->
        <div
          class="pt-8 border-t border-white/5 grid grid-cols-3 gap-4 sm:gap-8 transform translate-y-10 opacity-0 transition-all duration-1000 delay-700 ease-out"
          id="hero-stats"
        >
          <div class="group relative">
            <div
              class="absolute inset-0 bg-primary/20 blur-[20px] rounded-full opacity-0 group-hover:opacity-40 transition-opacity duration-500"
            >
            </div>
            <div class="relative">
              <div
                class="text-4xl md:text-5xl font-bold text-white font-display mb-1 flex items-baseline"
              >
                <span class="counter" data-target="3">0</span>
                <span class="text-primary text-2xl md:text-3xl ml-1">+</span>
              </div>
              <div
                class="text-xs md:text-sm text-text-muted font-medium uppercase tracking-wider"
              >
                Antennes<br />Régionales
              </div>
            </div>
          </div>

          <div class="group relative">
            <div
              class="absolute inset-0 bg-accent/20 blur-[20px] rounded-full opacity-0 group-hover:opacity-40 transition-opacity duration-500"
            >
            </div>
            <div class="relative">
              <div
                class="text-4xl md:text-5xl font-bold text-white font-display mb-1 flex items-baseline"
              >
                <span class="counter" data-target="50">0</span>
                <span class="text-accent text-2xl md:text-3xl ml-1">+</span>
              </div>
              <div
                class="text-xs md:text-sm text-text-muted font-medium uppercase tracking-wider"
              >
                Étudiants<br />Engagés
              </div>
            </div>
          </div>

          <div class="group relative">
            <div
              class="absolute inset-0 bg-highlight/20 blur-[20px] rounded-full opacity-0 group-hover:opacity-40 transition-opacity duration-500"
            >
            </div>
            <div class="relative">
              <div
                class="text-4xl md:text-5xl font-bold text-white font-display mb-1 flex items-baseline"
              >
                <span class="counter" data-target="5">0</span>
                <span class="text-highlight text-2xl md:text-3xl ml-1">+</span>
              </div>
              <div
                class="text-xs md:text-sm text-text-muted font-medium uppercase tracking-wider"
              >
                Projets<br />Soutenus
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Column: Visual -->
      <div
        class="hero-visual relative order-1 lg:order-2 flex justify-center lg:justify-end perspective-1000"
      >
        <div
          class="relative w-full max-w-lg aspect-square transform transition-transform duration-100 ease-out"
          id="hero-image-container"
        >
          <!-- Abstract SVG -->
          <img
            src="/assets/images/hero-abstract.svg"
            alt="Innovation Abstract"
            class="w-full h-full object-contain drop-shadow-2xl animate-float"
            id="hero-image"
          />

          <!-- Floating Elements (Parallax) -->
          <div
            class="absolute top-10 right-10 w-20 h-20 bg-dark-secondary/80 backdrop-blur-md rounded-2xl border border-white/10 p-4 shadow-xl parallax-element"
            data-speed="20"
          >
            <div
              class="w-full h-full bg-accent/20 rounded-full flex items-center justify-center text-accent"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 400 400"
                width="400"
                height="400"
              >
                <defs>
                  <radialGradient
                    id="bulbGradient"
                    cx="50%"
                    cy="50%"
                    r="50%"
                    fx="50%"
                    fy="50%"
                  >
                    <stop offset="0%" style="stop-color:#ffffcc;stop-opacity:1"
                    ></stop>
                    <stop offset="90%" style="stop-color:#ffeb3b;stop-opacity:1"
                    ></stop>
                    <stop
                      offset="100%"
                      style="stop-color:#fdd835;stop-opacity:1"></stop>
                  </radialGradient>
                  <linearGradient
                    id="baseGradient"
                    x1="0%"
                    y1="0%"
                    x2="100%"
                    y2="0%"
                  >
                    <stop offset="0%" style="stop-color:#9e9e9e;stop-opacity:1"
                    ></stop>
                    <stop offset="50%" style="stop-color:#e0e0e0;stop-opacity:1"
                    ></stop>
                    <stop
                      offset="100%"
                      style="stop-color:#9e9e9e;stop-opacity:1"></stop>
                  </linearGradient>
                </defs>

                <g transform="translate(200, 200)">
                  <g
                    fill="none"
                    stroke="#333"
                    stroke-width="6"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M-50 -60 Q -120 -130, -160 -80"></path>
                    <path d="M-60 -30 Q -140 -50, -180 10"></path>
                    <path d="M-60 10 Q -140 40, -170 100"></path>
                    <path d="M-50 40 Q -120 100, -140 160"></path>

                    <path d="M50 -60 Q 120 -130, 160 -80"></path>
                    <path d="M60 -30 Q 140 -50, 180 10"></path>
                    <path d="M60 10 Q 140 40, 170 100"></path>
                    <path d="M50 40 Q 120 100, 140 160"></path>
                  </g>

                  <g>
                    <path
                      d="M0 -140 C -80 -140, -100 -50, -70 20 C -60 50, -50 70, -50 100 L 50 100 C 50 70, 60 50, 70 20 C 100 -50, 80 -140, 0 -140 Z"
                      fill="url(#bulbGradient)"
                      stroke="#d4a017"
                      stroke-width="3"></path>

                    <polyline
                      points="-30 20, -20 -40, -10 20, 0 -40, 10 20, 20 -40, 30 20"
                      fill="none"
                      stroke="#ff9800"
                      stroke-width="2"
                      opacity="0.7"></polyline>

                    <g fill="#333">
                      <circle cx="-25" cy="-20" r="8"></circle>
                      <circle cx="25" cy="-20" r="8"></circle>
                      <circle cx="-10" cy="-10" r="5"></circle>
                      <circle cx="10" cy="-10" r="5"></circle>
                    </g>
                  </g>

                  <g transform="translate(0, 100)">
                    <rect
                      x="-50"
                      y="0"
                      width="100"
                      height="40"
                      rx="5"
                      ry="5"
                      fill="url(#baseGradient)"
                      stroke="#666"
                      stroke-width="2"></rect>
                    <line
                      x1="-50"
                      y1="10"
                      x2="50"
                      y2="10"
                      stroke="#666"
                      stroke-width="2"></line>
                    <line
                      x1="-50"
                      y1="20"
                      x2="50"
                      y2="20"
                      stroke="#666"
                      stroke-width="2"></line>
                    <line
                      x1="-50"
                      y1="30"
                      x2="50"
                      y2="30"
                      stroke="#666"
                      stroke-width="2"></line>

                    <path d="M-30 40 L 30 40 L 20 60 L -20 60 Z" fill="#333"
                    ></path>
                  </g>
                </g>
              </svg>
            </div>
          </div>

          <div
            class="absolute bottom-20 left-0 w-auto bg-dark-secondary/80 backdrop-blur-md rounded-full border border-white/10 py-3 px-6 shadow-xl parallax-element"
            data-speed="-15"
          >
            <span class="text-white font-bold text-sm flex items-center gap-2">
              <span class="w-2 h-2 bg-primary rounded-full animate-pulse"
              ></span>
              Impact Positif
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  .perspective-1000 {
    perspective: 1000px;
  }
</style>

<script>
  // Entrance Animation
  window.addEventListener("load", () => {
    const ids = [
      "hero-badge",
      "hero-title",
      "hero-subtitle",
      "hero-cta",
      "hero-stats",
    ];
    ids.forEach((id) => {
      const el = document.getElementById(id);
      if (el) {
        el.classList.remove("translate-y-full", "translate-y-10", "opacity-0");
      }
    });
  });

  // Mouse Parallax
  const container = document.getElementById("hero");
  const imageContainer = document.getElementById("hero-image-container");
  const parallaxElements = document.querySelectorAll(".parallax-element");

  if (container && imageContainer) {
    container.addEventListener("mousemove", (e) => {
      const { clientX, clientY } = e;
      const { innerWidth, innerHeight } = window;

      const xPos = (clientX / innerWidth - 0.5) * 2; // -1 to 1
      const yPos = (clientY / innerHeight - 0.5) * 2; // -1 to 1

      // Tilt Image Container
      imageContainer.style.transform = `rotateY(${xPos * 5}deg) rotateX(${-yPos * 5}deg)`;

      // Move Floating Elements
      parallaxElements.forEach((el) => {
        const speed = parseInt(el.getAttribute("data-speed") || "10");
        // @ts-ignore
        el.style.transform = `translate(${xPos * speed}px, ${yPos * speed}px)`;
      });
    });

    // Reset on mouse leave
    container.addEventListener("mouseleave", () => {
      imageContainer.style.transform = "rotateY(0) rotateX(0)";
      parallaxElements.forEach((el) => {
        // @ts-ignore
        el.style.transform = "translate(0, 0)";
      });
    });
  }

  // Counter Animation
  const runCounters = () => {
    const counters = document.querySelectorAll(".counter");
    counters.forEach((counter) => {
      const target = parseInt(counter.getAttribute("data-target") || "0");
      const duration = 2000;
      const step = target / (duration / 16);
      let current = 0;

      const update = () => {
        current += step;
        if (current < target) {
          counter.textContent = Math.ceil(current).toString();
          requestAnimationFrame(update);
        } else {
          counter.textContent = target.toString();
        }
      };
      update();
    });
  };

  // Observe for visibility to trigger counters
  const statsObserver = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          setTimeout(runCounters, 800); // Sync with CSS delay
          statsObserver.disconnect();
        }
      });
    },
    { threshold: 0.5 },
  );

  const stats = document.getElementById("hero-stats");
  if (stats) statsObserver.observe(stats);
</script>
