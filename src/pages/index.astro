---
import BaseLayout from '../layouts/BaseLayout.astro';
import Header from '../components/Header.astro';
import Hero from '../components/Hero.astro';
import Footer from '../components/Footer.astro';
import Button from '../components/Button.astro';
import ProjectCard from '../components/ProjectCard.astro';
import InteractiveMap from '../components/InteractiveMap.astro';
import TeamMember from '../components/TeamMember.astro';
import ContactSection from '../components/ContactSection.astro';

import projects from '../data/projects.json';
import team from '../data/team.json';
---

<BaseLayout title="Nélosis - Innovation Écologique Étudiante">
  <Header />
  
  <main>
    <Hero />



    <!-- Programs Section -->
    <section id="programs" class="py-32 bg-dark relative">
      <div class="container mx-auto px-6">
        <div class="flex flex-col md:flex-row justify-between items-end mb-16 fade-in-up">
          <div class="max-w-2xl">
            <h2 class="text-5xl md:text-7xl font-display font-bold mb-6">
              <span class="text-white">Nos</span> <span class="text-transparent bg-clip-text bg-gradient-to-r from-primary to-accent">Programmes</span>
            </h2>
            <p class="text-xl text-text-muted">
              Découvrez les projets phares portés par nos étudiants à travers la France.
            </p>
          </div>
          <Button href="#" variant="outline" class="hidden md:inline-flex mt-6 md:mt-0">Tout voir</Button>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 auto-rows-[300px]">
          {projects.map((project) => (
            <ProjectCard {...project} />
          ))}
        </div>
        
        <div class="mt-12 text-center md:hidden">
           <Button href="#" variant="outline">Tout voir</Button>
        </div>
      </div>
    </section>

    <!-- Map Section -->
    <section id="map" class="py-24 bg-dark-secondary">
      <div class="container mx-auto px-6">
        <div class="text-center mb-16 fade-in-up">
          <h2 class="text-4xl md:text-5xl font-display font-bold mb-6">
            <span class="text-white">Notre</span> <span class="text-primary">Réseau</span>
          </h2>
          <p class="text-text-muted mb-8 text-lg max-w-2xl mx-auto">
            De Perpignan à Paris, le réseau Nélosis s'étend pour connecter les étudiants engagés. Retrouvez nos antennes locales.
          </p>
        </div>
        
        <div class="fade-in-up delay-200">
          <InteractiveMap />
        </div>
      </div>
    </section>

    <!-- Team Section -->
    <section id="team" class="py-24 bg-dark">
      <div class="container mx-auto px-6">
        <div class="text-center mb-16 fade-in-up">
          <h2 class="text-4xl md:text-5xl font-display font-bold mb-4">
            <span class="text-white">L'Équipe</span> <span class="text-primary">Nélosis</span>
          </h2>
          <p class="text-text-muted max-w-2xl mx-auto">
            Le bureau national qui œuvre au quotidien pour le développement du réseau.
          </p>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-12 stagger-container">
          {team.map((member) => (
            <div class="fade-in-up">
              <TeamMember {...member} />
            </div>
          ))}
        </div>
      </div>
    </section>

    <ContactSection />
  </main>

  <Footer />
</BaseLayout>

<script>
  // Simple Intersection Observer for scroll animations
  const observerOptions = {
    root: null,
    rootMargin: '0px',
    threshold: 0.1
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
        observer.unobserve(entry.target); // Only animate once
      }
    });
  }, observerOptions);

  document.querySelectorAll('.fade-in-up').forEach(el => {
    observer.observe(el);
  });
</script>

<style>
  .fade-in-up {
    opacity: 0;
    transform: translateY(30px);
    transition: opacity 0.8s ease-out, transform 0.8s ease-out;
  }

  .fade-in-up.visible {
    opacity: 1;
    transform: translateY(0);
  }

  /* Stagger delays */
  .stagger-container .fade-in-up:nth-child(1) { transition-delay: 0.1s; }
  .stagger-container .fade-in-up:nth-child(2) { transition-delay: 0.2s; }
  .stagger-container .fade-in-up:nth-child(3) { transition-delay: 0.3s; }
</style>
